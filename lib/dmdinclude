#
# A library file for detecting dmd versions and setting up variables.  Now that
# Tango supports DMD 2, we must setup variables properly
#

# Various common build and install functionality

dmdversion() {
    echo ">> Checking compiler version DMD"

    DMDVERSION=`dmd | head -1 | cut -c 26-`
    DMDVERSIONMAJ="${DMDVERSION:0:1}" #`echo $DMDVERSION | cut -d . -f 1`
    # TODO: Strip leading 0's
    DMDVERSIONMIN="${DMDVERSION:2}" #`echo $DMDVERSIOM | cut -c 3-`
    echo ">> Compiler version is $DMDVERSIONMAJ.$DMDVERSIONMIN"
    while [ "${DMDVERSIONMIN:0:1}" = "0" ]
    do
        DMDVERSIONMIN="${DMDVERSIONMIN:1}"
    done
}

dmdbugs() {
    dmdversion

    if [ ! "$DMDVERSIONMAJ" -gt "1" ]
    then
        if [ ! "$DMDVERSIONMIN" -gt "21" ]
        then
            INLINE=""
            echo ">> Removing -inline due to bugzilla 668"
        fi
    fi
}
