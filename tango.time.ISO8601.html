<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <title>tango.time.ISO8601</title>
  <link href="css/style.css" rel="stylesheet" type="text/css"/>
  <!-- no favicon -->
  <script type="text/javascript" src="js/jquery.js"></script>
  <script type="text/javascript" src="js/utilities.js"></script>
  <script type="text/javascript" src="js/symbols.js"></script>
  <script type="text/javascript" src="js/modules.js"></script>
  <script type="text/javascript" src="js/quicksearch.js"></script>
  <script type="text/javascript" src="js/treeview.js"></script>
  <script type="text/javascript" src="js/navigation.js"></script>
</head>
<body id="tango.time.ISO8601">
<div id="kandil-content">
<div class="module">
  <h1 class="module" id="m-tango.time.ISO8601"><a href="htmlsrc/tango.time.ISO8601.html" class="symbol">tango.time.ISO8601</a></h1>

<p class="sec_header">License:</p><div class="cmnt">BSD style: see <a href="http://www.dsource.org/projects/tango/wiki/LibraryLicense">license.txt</a></div>
<p class="sec_header">Version:</p><div class="cmnt">Aug 2007: Initial release
                        Feb 2008: Retooled</div>
<p class="sec_header">Author:</p><div class="cmnt">Matti Niemenmaa
<p class="bl"></p>
        This module is based on the ISO 8601:2004 standard, and has functions
        for parsing (almost) every date/time format specified therein. (The
        ones not supported are intervals, durations, and recurring intervals.)
<p class="bl"></p>
        Refer to the standard for a full description of the formats supported.
<p class="bl"></p>
        The functions (parseTime, parseDate, and parseDateAndTime) are
        overloaded into two different versions of each: one updates a given
        Time, and the other updates a given ExtendedDate struct. The purpose of
        this struct is to support more detailed information which the Time data
        type does not (and, given its simple integer nature, cannot) support.
<p class="bl"></p>
        Times with specified time zones are simply converted into UTC: this may
        lead to the date changing when only a time was parsed: e.g. "01:00+03"
        is the same as "22:00", except that when the former is parsed, one is
        subtracted from the day.</div>
<dl>
<dt class="decl"><span class="kw">struct</span> <a class="symbol _struct" name="ExtendedDate" href="htmlsrc/tango.time.ISO8601.html#L42">ExtendedDate</a> <span class="attrs">[<span class="prot">public</span>]</span> <a href="tango.time.ISO8601.html#ExtendedDate" class="plink">¶</a></dt>
<dd class="ddef">
<div class="summary"><div class="cmnt">An extended date type, wrapping a Time together with some additional
 information.</div></div>
<dl>
<dt class="decl">DT <a class="symbol _variable" name="ExtendedDate.val" href="htmlsrc/tango.time.ISO8601.html#L44">val</a> <a href="tango.time.ISO8601.html#ExtendedDate.val" class="plink">¶</a></dt>
<dd class="ddef">
<div class="summary"><div class="cmnt">The Time value, containing the information it can.</div></div></dd>
<dt class="decl"><span class="rettyp">int</span> <a class="symbol _function" name="ExtendedDate.year" href="htmlsrc/tango.time.ISO8601.html#L54">year</a><span class="params">()</span> <span class="attrs">[<span class="stc">@property</span>, <span class="stc">const</span>]</span> <a href="tango.time.ISO8601.html#ExtendedDate.year" class="plink">¶</a></dt>
<dd class="ddef">
<div class="summary"><div class="cmnt">Returns the year part of the date: a value in the range
 [-1_000_000_000,-1] ∪ [1,999_999_999], where -1 is the year 1 BCE.</div></div>
<div class="cmnt">Do not use val.year directly unless you are absolutely sure that it is in
 the range a Time can hold (-10000 to 9999).</div></dd>
<dt class="decl"><span class="rettyp">uint</span> <a class="symbol _function" name="ExtendedDate.seconds" href="htmlsrc/tango.time.ISO8601.html#L85">seconds</a><span class="params">()</span> <span class="attrs">[<span class="stc">@property</span>, <span class="stc">const</span>]</span> <a href="tango.time.ISO8601.html#ExtendedDate.seconds" class="plink">¶</a></dt>
<dd class="ddef">
<div class="summary"><div class="cmnt">Returns the seconds part of the date: may be 60 if a leap second
 occurred. In such a case, val's seconds part is 59.</div></div></dd>
<dt class="decl"><span class="rettyp">bool</span> <a class="symbol _function" name="ExtendedDate.endOfDay" href="htmlsrc/tango.time.ISO8601.html#L94">endOfDay</a><span class="params">()</span> <span class="attrs">[<span class="stc">@property</span>, <span class="stc">const</span>]</span> <a href="tango.time.ISO8601.html#ExtendedDate.endOfDay" class="plink">¶</a></dt>
<dd class="ddef">
<div class="summary"><div class="cmnt">Whether the ISO 8601 representation of this hour is 24 or 00: whether
 this instant of midnight is to be considered the end of the previous day
 or the start of the next.</div></div>
<div class="cmnt">If the time of val is not exactly 00:00:00.000, this value is undefined.</div></dd></dl></dd>
<dt class="decl"><span class="rettyp">size_t</span> <a class="symbol _function" name="parseDate" href="htmlsrc/tango.time.ISO8601.html#L148">parseDate</a><span class="tparams">(<em>T</em>)</span><span class="params">(T[] <em>src</em>,  <span class="k">ref</span> DT <em>dt</em>)</span> <span class="attrs">[<span class="prot">public</span>]</span> <a href="tango.time.ISO8601.html#parseDate" class="plink">¶</a></dt>
<dt class="decl"><span class="rettyp">size_t</span> <a class="symbol _function" name="parseDate:2" href="htmlsrc/tango.time.ISO8601.html#L156">parseDate</a><span class="tparams">(<em>T</em>)</span><span class="params">(T[] <em>src</em>,  <span class="k">ref</span> FullDate <em>fd</em>, ubyte <em>expanded</em> = <span class="defval"><span class="n">0</span></span>)</span> <span class="attrs">[<span class="prot">public</span>]</span> <a href="tango.time.ISO8601.html#parseDate:2" class="plink">¶</a></dt>
<dd class="ddef">
<div class="summary"><div class="cmnt">Parses a date in a format specified in ISO 8601:2004.</div></div>
<div class="cmnt">Returns the number of characters used to compose a valid date: 0 if no date
 can be composed.
<p class="bl"></p>
 Fields in dt will either be correct (e.g. months will be &gt;= 1 and &lt;= 12) or
 the default, which is 1 for year, month, and day, and 0 for all other
 fields. Unless one is absolutely sure that 0001-01-01 can never be
 encountered, one should check the return value to be sure that the parsing
 succeeded as expected.
<p class="bl"></p>
 A third parameter is available for the ExtendedDate version: this allows for
 parsing expanded year representations. The parameter is the number of extra
 year digits beyond four, and defaults to zero. It must be within the range
 [0,5]: this allows for a maximum year of 999 999 999, which should be enough
 for now.
<p class="bl"></p>
 When using expanded year representations, be careful to use
 ExtendedDate.year instead of the Time's year value.</div>
<p class="sec_header">Examples:</p><div class="cmnt"><table class="d_code">
  <tr><td class="d_codelines">
<pre><a href="#L1_ex1" name="L1_ex1">1</a>
<a href="#L2_ex1" name="L2_ex1">2</a>
<a href="#L3_ex1" name="L3_ex1">3</a>
<a href="#L4_ex1" name="L4_ex1">4</a>
<a href="#L5_ex1" name="L5_ex1">5</a>
<a href="#L6_ex1" name="L6_ex1">6</a>
<a href="#L7_ex1" name="L7_ex1">7</a>
<a href="#L8_ex1" name="L8_ex1">8</a>
<a href="#L9_ex1" name="L9_ex1">9</a>
<a href="#L10_ex1" name="L10_ex1">10</a>
<a href="#L11_ex1" name="L11_ex1">11</a>
<a href="#L12_ex1" name="L12_ex1">12</a>
<a href="#L13_ex1" name="L13_ex1">13</a>
<a href="#L14_ex1" name="L14_ex1">14</a>
<a href="#L15_ex1" name="L15_ex1">15</a>
<a href="#L16_ex1" name="L16_ex1">16</a>
</pre></td><td class="d_codetext"><pre>
<span class="i">Time</span> <span class="i">t</span>;
<span class="i">ExtendedDate</span> <span class="i">ed</span>;

<span class="i">parseDate</span>(<span class="sl">"19"</span>,             <span class="i">t</span>);    <span class="lc">// January 1st, 1900</span>
<span class="i">parseDate</span>(<span class="sl">"1970"</span>,           <span class="i">t</span>);    <span class="lc">// January 1st, 1970</span>
<span class="i">parseDate</span>(<span class="sl">"1970-02"</span>,        <span class="i">t</span>);    <span class="lc">// February 1st, 1970</span>
<span class="i">parseDate</span>(<span class="sl">"19700203"</span>,       <span class="i">t</span>);    <span class="lc">// February 3rd, 1970</span>
<span class="i">parseDate</span>(<span class="sl">"+19700203"</span>,     <span class="i">ed</span>, <span class="n">2</span>); <span class="lc">// March 1st, 197002</span>
<span class="i">parseDate</span>(<span class="sl">"-197002-04-01"</span>, <span class="i">ed</span>, <span class="n">2</span>); <span class="lc">// April 1st, -197003 (197003 BCE)</span>
<span class="i">parseDate</span>(<span class="sl">"00000101"</span>,       <span class="i">t</span>);    <span class="lc">// January 1st, -1 (1 BCE)</span>
<span class="i">parseDate</span>(<span class="sl">"1700-W14-2"</span>,     <span class="i">t</span>);    <span class="lc">// April 6th, 1700</span>
<span class="i">parseDate</span>(<span class="sl">"2008W01"</span>,        <span class="i">t</span>);    <span class="lc">// December 31st, 2007</span>
<span class="i">parseDate</span>(<span class="sl">"1987-221"</span>,       <span class="i">t</span>);    <span class="lc">// August 9th, 1987</span>
<span class="i">parseDate</span>(<span class="sl">"1234abcd"</span>,       <span class="i">t</span>);    <span class="lc">// January 1st, 1234; return value is 4</span>
<span class="i">parseDate</span>(<span class="sl">"12abcdef"</span>,       <span class="i">t</span>);    <span class="lc">// January 1st, 1200; return value is 2</span>
<span class="i">parseDate</span>(<span class="sl">"abcdefgh"</span>,       <span class="i">t</span>);    <span class="lc">// January 1st, 0001; return value is 0</span></pre>
</td></tr>
</table></div></dd>
<dt class="decl"><span class="rettyp">size_t</span> <a class="symbol _function" name="parseTime" href="htmlsrc/tango.time.ISO8601.html#L348">parseTime</a><span class="tparams">(<em>T</em>)</span><span class="params">(T[] <em>src</em>,  <span class="k">ref</span> DT <em>dt</em>)</span> <span class="attrs">[<span class="prot">public</span>]</span> <a href="tango.time.ISO8601.html#parseTime" class="plink">¶</a></dt>
<dt class="decl"><span class="rettyp">size_t</span> <a class="symbol _function" name="parseTime:2" href="htmlsrc/tango.time.ISO8601.html#L356">parseTime</a><span class="tparams">(<em>T</em>)</span><span class="params">(T[] <em>src</em>,  <span class="k">ref</span> FullDate <em>fd</em>)</span> <span class="attrs">[<span class="prot">public</span>]</span> <a href="tango.time.ISO8601.html#parseTime:2" class="plink">¶</a></dt>
<dd class="ddef">
<div class="summary"><div class="cmnt">Parses a time of day in a format specified in ISO 8601:2004.</div></div>
<div class="cmnt">Returns the number of characters used to compose a valid time: 0 if no time
 can be composed.
<p class="bl"></p>
 Fields in dt will either be correct or the default, which is 0 for all
 time-related fields. fields. Unless one is absolutely sure that midnight
 can never be encountered, one should check the return value to be sure that
 the parsing succeeded as expected.
<p class="bl"></p>
 Extra fields in ExtendedDate:
<p class="bl"></p>
 Seconds may be 60 if the hours and minutes are 23 and 59, as leap seconds
 are occasionally added to UTC time. A Time's seconds will be 59 in this
 case.
<p class="bl"></p>
 Hours may be 0 or 24: the latter marks the end of a day and the former the
 beginning, although they both refer to the same instant in time. A Time
 will be precisely 00:00 in either case.</div>
<p class="sec_header">Examples:</p><div class="cmnt"><table class="d_code">
  <tr><td class="d_codelines">
<pre><a href="#L1_ex2" name="L1_ex2">1</a>
<a href="#L2_ex2" name="L2_ex2">2</a>
<a href="#L3_ex2" name="L3_ex2">3</a>
<a href="#L4_ex2" name="L4_ex2">4</a>
<a href="#L5_ex2" name="L5_ex2">5</a>
<a href="#L6_ex2" name="L6_ex2">6</a>
<a href="#L7_ex2" name="L7_ex2">7</a>
<a href="#L8_ex2" name="L8_ex2">8</a>
<a href="#L9_ex2" name="L9_ex2">9</a>
<a href="#L10_ex2" name="L10_ex2">10</a>
<a href="#L11_ex2" name="L11_ex2">11</a>
<a href="#L12_ex2" name="L12_ex2">12</a>
<a href="#L13_ex2" name="L13_ex2">13</a>
<a href="#L14_ex2" name="L14_ex2">14</a>
<a href="#L15_ex2" name="L15_ex2">15</a>
</pre></td><td class="d_codetext"><pre>
<span class="i">Time</span> <span class="i">t</span>;
<span class="i">ExtendedDate</span> <span class="i">ed</span>;

<span class="lc">// ",000" omitted for clarity</span>
<span class="i">parseTime</span>(<span class="sl">"20"</span>,             <span class="i">t</span>); <span class="lc">// 20:00:00</span>
<span class="i">parseTime</span>(<span class="sl">"2004"</span>,           <span class="i">t</span>); <span class="lc">// 20:04:00</span>
<span class="i">parseTime</span>(<span class="sl">"20:04:06"</span>,       <span class="i">t</span>); <span class="lc">// 20:04:06</span>
<span class="i">parseTime</span>(<span class="sl">"16:49:30,001"</span>,   <span class="i">t</span>); <span class="lc">// 16:49:30,001</span>
<span class="i">parseTime</span>(<span class="sl">"16:49:30,1"</span>,     <span class="i">t</span>); <span class="lc">// 16:49:30,100</span>
<span class="i">parseTime</span>(<span class="sl">"16:49,4"</span>,        <span class="i">t</span>); <span class="lc">// 16:49:24</span>
<span class="i">parseTime</span>(<span class="sl">"23:59:60"</span>,      <span class="i">ed</span>); <span class="lc">// 23:59:60</span>
<span class="i">parseTime</span>(<span class="sl">"24:00:01"</span>,       <span class="i">t</span>); <span class="lc">// 00:00:00; return value is 5</span>
<span class="i">parseTime</span>(<span class="sl">"24:00:01"</span>,      <span class="i">ed</span>); <span class="lc">// 00:00:00; return value is 5; endOfDay</span>
<span class="i">parseTime</span>(<span class="sl">"30"</span>,             <span class="i">t</span>); <span class="lc">// 00:00:00; return value is 0</span>
<span class="i">parseTime</span>(<span class="sl">"21:32:43-12:34"</span>, <span class="i">t</span>); <span class="lc">// 10:06:43; day increased by one</span></pre>
</td></tr>
</table></div></dd>
<dt class="decl"><span class="rettyp">size_t</span> <a class="symbol _function" name="parseDateAndTime" href="htmlsrc/tango.time.ISO8601.html#L552">parseDateAndTime</a><span class="tparams">(<em>T</em>)</span><span class="params">(T[] <em>src</em>,  <span class="k">ref</span> DT <em>dt</em>)</span> <span class="attrs">[<span class="prot">public</span>]</span> <a href="tango.time.ISO8601.html#parseDateAndTime" class="plink">¶</a></dt>
<dt class="decl"><span class="rettyp">size_t</span> <a class="symbol _function" name="parseDateAndTime:2" href="htmlsrc/tango.time.ISO8601.html#L559">parseDateAndTime</a><span class="tparams">(<em>T</em>)</span><span class="params">(T[] <em>src</em>,  <span class="k">ref</span> FullDate <em>fd</em>)</span> <span class="attrs">[<span class="prot">public</span>]</span> <a href="tango.time.ISO8601.html#parseDateAndTime:2" class="plink">¶</a></dt>
<dd class="ddef">
<div class="summary"><div class="cmnt">Parses a combined date and time in a format specified in ISO 8601:2004.</div></div>
<div class="cmnt">Returns the number of characters used to compose a valid date and time.
 Zero is returned if a complete date and time cannot be extracted. In that
 case, the value of the resulting Time or ExtendedDate is undefined.
<p class="bl"></p>
 This function is stricter than just calling parseDate followed by</div>
<p class="sec_header">parseTime:</p><div class="cmnt">there are no allowances for expanded years or reduced dates
 (two-digit years), and separator usage must be consistent.
<p class="bl"></p>
 Although the standard allows for omitting the T between the date and the
 time, this function requires it.</div>
<p class="sec_header">Examples:</p><div class="cmnt"><table class="d_code">
  <tr><td class="d_codelines">
<pre><a href="#L1_ex3" name="L1_ex3">1</a>
<a href="#L2_ex3" name="L2_ex3">2</a>
<a href="#L3_ex3" name="L3_ex3">3</a>
<a href="#L4_ex3" name="L4_ex3">4</a>
<a href="#L5_ex3" name="L5_ex3">5</a>
<a href="#L6_ex3" name="L6_ex3">6</a>
<a href="#L7_ex3" name="L7_ex3">7</a>
<a href="#L8_ex3" name="L8_ex3">8</a>
<a href="#L9_ex3" name="L9_ex3">9</a>
<a href="#L10_ex3" name="L10_ex3">10</a>
<a href="#L11_ex3" name="L11_ex3">11</a>
<a href="#L12_ex3" name="L12_ex3">12</a>
<a href="#L13_ex3" name="L13_ex3">13</a>
<a href="#L14_ex3" name="L14_ex3">14</a>
<a href="#L15_ex3" name="L15_ex3">15</a>
<a href="#L16_ex3" name="L16_ex3">16</a>
<a href="#L17_ex3" name="L17_ex3">17</a>
<a href="#L18_ex3" name="L18_ex3">18</a>
</pre></td><td class="d_codetext"><pre>
<span class="i">Time</span> <span class="i">t</span>;

<span class="lc">// January 1st, 2008 00:01:00</span>
<span class="i">parseDateAndTime</span>(<span class="sl">"2007-12-31T23:01-01"</span>, <span class="i">t</span>);

<span class="lc">// April 12th, 1985 23:50:30,042</span>
<span class="i">parseDateAndTime</span>(<span class="sl">"1985W155T235030,042"</span>, <span class="i">t</span>);

<span class="lc">// Invalid time: returns zero</span>
<span class="i">parseDateAndTime</span>(<span class="sl">"1902-03-04T10:1a"</span>, <span class="i">t</span>);

<span class="lc">// Separating T omitted: returns zero</span>
<span class="i">parseDateAndTime</span>(<span class="sl">"1985-04-1210:15:30+04:00"</span>, <span class="i">t</span>);

<span class="lc">// Inconsistent separators: all return zero</span>
<span class="i">parseDateAndTime</span>(<span class="sl">"200512-01T10:02"</span>,          <span class="i">t</span>);
<span class="i">parseDateAndTime</span>(<span class="sl">"1985-04-12T10:15:30+0400"</span>, <span class="i">t</span>);
<span class="i">parseDateAndTime</span>(<span class="sl">"1902-03-04T050607"</span>,        <span class="i">t</span>);</pre>
</td></tr>
</table></div></dd></dl>
</div>
<div id="kandil-footer">
  <p>Copyright (c) 2007-2008 Matti Niemenmaa.
                        All rights reserved</p>
  <p>Page generated by <a href="http://code.google.com/p/dil">dil</a> on Mon Mar 12 21:34:19 2012. Rendered by <a href="http://code.google.com/p/dil/wiki/Kandil">kandil</a>.</p>
</div>
</div>
</body>
</html>