<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html>
	<head>
		<link rel="stylesheet" href="style.css" type="text/css" />
		<title>Exception.d</title>
	</head>
	<body>

<table id='dcode'><tr><td id='lnum'><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
</pre></td><td id='code'><pre><span class='com'>/**
 * The exception module defines all system-level exceptions and provides a
 * mechanism to alter system-level error handling.
 *
 * Copyright: Copyright (C) 2005-2006 Sean Kelly.  All rights reserved.
 * License:   BSD style: $(LICENSE)
 * Authors:   Sean Kelly
 */</span>
<span class='kw2'>module</span> tango.core.Exception;


<span class='kw4'>private</span>
<span class='opr'>{</span>
    <span class='kw2'>alias</span> <span class='kw4'>void</span> <span class='kw2'>function</span><span class='opr'>(</span> <span class='kw4'>char</span><span class='opr'>[</span><span class='opr'>]</span> file, <span class='kw4'>uint</span> line, <span class='kw4'>char</span><span class='opr'>[</span><span class='opr'>]</span> msg <span class='opr'>=</span> <span class='kw2'>null</span> <span class='opr'>)</span> assertHandlerType;
    <span class='kw2'>alias</span> <span class='kw4'>bool</span> <span class='kw2'>function</span><span class='opr'>(</span> <span class='kw3'>Object</span> obj <span class='opr'>)</span> collectHandlerType;

    assertHandlerType   assertHandler   <span class='opr'>=</span> <span class='kw2'>null</span>;
    collectHandlerType  collectHandler  <span class='opr'>=</span> <span class='kw2'>null</span>;
<span class='opr'>}</span>


<span class='com'>////////////////////////////////////////////////////////////////////////////////</span>
<span class='com'>// Exceptions</span>
<span class='com'>////////////////////////////////////////////////////////////////////////////////</span>


<span class='com'>/**
 * Thrown on an array bounds error.
 */</span>
<span class='kw4'>class</span> ArrayBoundsException : Exception
<span class='opr'>{</span>
    <span class='kw2'>this</span><span class='opr'>(</span> <span class='kw4'>char</span><span class='opr'>[</span><span class='opr'>]</span> file, <span class='kw4'>size_t</span> line <span class='opr'>)</span>
    <span class='opr'>{</span>
        <span class='kw2'>super</span><span class='opr'>(</span> <span class='str'>&quot;Array index out of bounds&quot;</span>, file, line <span class='opr'>)</span>;
    <span class='opr'>}</span>
<span class='opr'>}</span>


<span class='com'>/**
 * Thrown on an assert error.
 */</span>
<span class='kw4'>class</span> AssertException : Exception
<span class='opr'>{</span>
    <span class='kw2'>this</span><span class='opr'>(</span> <span class='kw4'>char</span><span class='opr'>[</span><span class='opr'>]</span> file, <span class='kw4'>size_t</span> line <span class='opr'>)</span>
    <span class='opr'>{</span>
        <span class='kw2'>super</span><span class='opr'>(</span> <span class='str'>&quot;Assertion failure&quot;</span>, file, line <span class='opr'>)</span>;
    <span class='opr'>}</span>

    <span class='kw2'>this</span><span class='opr'>(</span> <span class='kw4'>char</span><span class='opr'>[</span><span class='opr'>]</span> msg, <span class='kw4'>char</span><span class='opr'>[</span><span class='opr'>]</span> file, <span class='kw4'>size_t</span> line <span class='opr'>)</span>
    <span class='opr'>{</span>
        <span class='kw2'>super</span><span class='opr'>(</span> msg, file, line <span class='opr'>)</span>;
    <span class='opr'>}</span>
<span class='opr'>}</span>


<span class='com'>/**
 * Thrown on finalize error.
 */</span>
<span class='kw4'>class</span> FinalizeException : Exception
<span class='opr'>{</span>
    <span class='kw3'>ClassInfo</span>   info;

    <span class='kw2'>this</span><span class='opr'>(</span> <span class='kw3'>ClassInfo</span> c, Exception e <span class='opr'>=</span> <span class='kw2'>null</span> <span class='opr'>)</span>
    <span class='opr'>{</span>
        <span class='com'>// NOTE: It is really not ideal to allocate memory here for</span>
        <span class='com'>//       the concatenation.  A better approach would be to</span>
        <span class='com'>//       include a reference to the ClassInfo object and</span>
        <span class='com'>//       construct the message via a specialized toString().</span>
        <span class='kw2'>super</span><span class='opr'>(</span> <span class='str'>&quot;Finalization error&quot;</span>, e <span class='opr'>)</span>;
        info <span class='opr'>=</span> c;
    <span class='opr'>}</span>

    <span class='kw4'>char</span><span class='opr'>[</span><span class='opr'>]</span> toString<span class='opr'>(</span><span class='opr'>)</span>
    <span class='opr'>{</span>
        <span class='kw1'>return</span> <span class='str'>&quot;An exception was thrown while finalizing an instance of class &quot;</span> <span class='opr'>~</span> info.name;
    <span class='opr'>}</span>
<span class='opr'>}</span>


<span class='com'>/**
 * Thrown on an out of memory error.
 */</span>
<span class='kw4'>class</span> <span class='kw3'>OutOfMemoryException</span> : Exception
<span class='opr'>{</span>
    <span class='kw2'>this</span><span class='opr'>(</span> <span class='kw4'>char</span><span class='opr'>[</span><span class='opr'>]</span> file, <span class='kw4'>size_t</span> line <span class='opr'>)</span>
    <span class='opr'>{</span>
        <span class='kw2'>super</span><span class='opr'>(</span> <span class='str'>&quot;Memory allocation failed&quot;</span>, file, line <span class='opr'>)</span>;
    <span class='opr'>}</span>
<span class='opr'>}</span>


<span class='com'>/**
 * Thrown on a switch error.
 */</span>
<span class='kw4'>class</span> SwitchException : Exception
<span class='opr'>{</span>
    <span class='kw2'>this</span><span class='opr'>(</span> <span class='kw4'>char</span><span class='opr'>[</span><span class='opr'>]</span> file, <span class='kw4'>size_t</span> line <span class='opr'>)</span>
    <span class='opr'>{</span>
        <span class='kw2'>super</span><span class='opr'>(</span> <span class='str'>&quot;No appropriate switch clause found&quot;</span>, file, line <span class='opr'>)</span>;
    <span class='opr'>}</span>
<span class='opr'>}</span>


<span class='com'>/**
 * Thrown on a unicode conversion error.
 */</span>
<span class='kw4'>class</span> UnicodeException : Exception
<span class='opr'>{</span>
    <span class='kw4'>size_t</span> idx;

    <span class='kw2'>this</span><span class='opr'>(</span> <span class='kw4'>char</span><span class='opr'>[</span><span class='opr'>]</span> msg, <span class='kw4'>size_t</span> idx <span class='opr'>)</span>
    <span class='opr'>{</span>
        <span class='kw2'>super</span><span class='opr'>(</span> msg <span class='opr'>)</span>;
        <span class='kw2'>this</span>.idx <span class='opr'>=</span> idx;
    <span class='opr'>}</span>
<span class='opr'>}</span>


<span class='com'>////////////////////////////////////////////////////////////////////////////////</span>
<span class='com'>// Overrides</span>
<span class='com'>////////////////////////////////////////////////////////////////////////////////</span>


<span class='com'>/**
 * Overrides the default assert hander with a user-supplied version.
 *
 * Params:
 *  h = The new assert handler.
 */</span>
<span class='kw4'>void</span> setAssertHandler<span class='opr'>(</span> assertHandlerType h <span class='opr'>)</span>
<span class='opr'>{</span>
    assertHandler <span class='opr'>=</span> h;
<span class='opr'>}</span>


<span class='com'>/**
 * Overrides the default collect hander with a user-supplied version.
 *
 * Params:
 *  h = The new collect handler.
 */</span>
<span class='kw4'>void</span> setCollectHandler<span class='opr'>(</span> collectHandlerType h <span class='opr'>)</span>
<span class='opr'>{</span>
    collectHandler <span class='opr'>=</span> h;
<span class='opr'>}</span>


<span class='com'>////////////////////////////////////////////////////////////////////////////////</span>
<span class='com'>// Overridable Callbacks</span>
<span class='com'>////////////////////////////////////////////////////////////////////////////////</span>


<span class='com'>/**
 * A callback for assert errors in D.  The user-supplied assert handler will
 * be called if one has been supplied, otherwise an AssertException will be
 * thrown.
 *
 * Params:
 *  file = The name of the file that signaled this error.
 *  line = The line number on which this error occurred.
 */</span>
<span class='kw2'>extern</span> <span class='opr'>(</span>C<span class='opr'>)</span> <span class='kw4'>void</span> onAssertError<span class='opr'>(</span> <span class='kw4'>char</span><span class='opr'>[</span><span class='opr'>]</span> file, <span class='kw4'>uint</span> line <span class='opr'>)</span>
<span class='opr'>{</span>
    <span class='kw1'>if</span><span class='opr'>(</span> !assertHandler <span class='opr'>)</span>
        <span class='kw2'>throw</span> <span class='kw2'>new</span> AssertException<span class='opr'>(</span> file, line <span class='opr'>)</span>;
    assertHandler<span class='opr'>(</span> file, line <span class='opr'>)</span>;
<span class='opr'>}</span>


<span class='com'>/**
 * A callback for assert errors in D.  The user-supplied assert handler will
 * be called if one has been supplied, otherwise an AssertException will be
 * thrown.
 *
 * Params:
 *  file = The name of the file that signaled this error.
 *  line = The line number on which this error occurred.
 *  msg  = An error message supplied by the user.
 */</span>
<span class='kw2'>extern</span> <span class='opr'>(</span>C<span class='opr'>)</span> <span class='kw4'>void</span> onAssertErrorMsg<span class='opr'>(</span> <span class='kw4'>char</span><span class='opr'>[</span><span class='opr'>]</span> file, <span class='kw4'>uint</span> line, <span class='kw4'>char</span><span class='opr'>[</span><span class='opr'>]</span> msg <span class='opr'>)</span>
<span class='opr'>{</span>
    <span class='kw1'>if</span><span class='opr'>(</span> !assertHandler <span class='opr'>)</span>
        <span class='kw2'>throw</span> <span class='kw2'>new</span> AssertException<span class='opr'>(</span> msg, file, line <span class='opr'>)</span>;
    assertHandler<span class='opr'>(</span> file, line, msg <span class='opr'>)</span>;
<span class='opr'>}</span>


<span class='com'>/**
 * This function will be called when resource objects (ie. objects with a dtor)
 * are finalized by the garbage collector.  The user-supplied collect handler
 * will be called if one has been supplied, otherwise no action will be taken.
 *
 * Params:
 *  obj = The object being collected.
 *
 * Returns:
 *  true if the runtime should call this object's dtors and false if not.
 *  Default behavior is to return true.
 */</span>
<span class='kw2'>extern</span> <span class='opr'>(</span>C<span class='opr'>)</span> <span class='kw4'>bool</span> onCollectResource<span class='opr'>(</span> <span class='kw3'>Object</span> obj <span class='opr'>)</span>
<span class='opr'>{</span>
    <span class='kw1'>if</span><span class='opr'>(</span> !collectHandler <span class='opr'>)</span>
        <span class='kw1'>return</span> <span class='kw2'>true</span>;
    <span class='kw1'>return</span> collectHandler<span class='opr'>(</span> obj <span class='opr'>)</span>;
<span class='opr'>}</span>


<span class='com'>////////////////////////////////////////////////////////////////////////////////</span>
<span class='com'>// Internal Error Callbacks</span>
<span class='com'>////////////////////////////////////////////////////////////////////////////////</span>


<span class='com'>/**
 * A callback for array bounds errors in D.  An ArrayBoundsException will be
 * thrown.
 *
 * Params:
 *  file = The name of the file that signaled this error.
 *  line = The line number on which this error occurred.
 *
 * Throws:
 *  ArrayBoundsException.
 */</span>
<span class='kw2'>extern</span> <span class='opr'>(</span>C<span class='opr'>)</span> <span class='kw4'>void</span> onArrayBoundsError<span class='opr'>(</span> <span class='kw4'>char</span><span class='opr'>[</span><span class='opr'>]</span> file, <span class='kw4'>size_t</span> line <span class='opr'>)</span>
<span class='opr'>{</span>
    <span class='kw2'>throw</span> <span class='kw2'>new</span> ArrayBoundsException<span class='opr'>(</span> file, line <span class='opr'>)</span>;
<span class='opr'>}</span>


<span class='com'>/**
 * A callback for finalize errors in D.  A FinalizeException will be thrown.
 *
 * Params:
 *  e = The exception thrown during finalization.
 *
 * Throws:
 *  FinalizeException.
 */</span>
<span class='kw2'>extern</span> <span class='opr'>(</span>C<span class='opr'>)</span> <span class='kw4'>void</span> onFinalizeError<span class='opr'>(</span> <span class='kw3'>ClassInfo</span> info, Exception ex <span class='opr'>)</span>
<span class='opr'>{</span>
    <span class='kw2'>throw</span> <span class='kw2'>new</span> FinalizeException<span class='opr'>(</span> info, ex <span class='opr'>)</span>;
<span class='opr'>}</span>


<span class='com'>/**
 * A callback for out of memory errors in D.  An OutOfMemoryException will be
 * thrown.
 *
 * Throws:
 *  OutOfMemoryException.
 */</span>
<span class='kw2'>extern</span> <span class='opr'>(</span>C<span class='opr'>)</span> <span class='kw4'>void</span> onOutOfMemoryError<span class='opr'>(</span><span class='opr'>)</span>
<span class='opr'>{</span>
    <span class='com'>// NOTE: Since an out of memory condition exists, no allocation must occur</span>
    <span class='com'>//       while generating this object.</span>
    <span class='kw2'>throw</span> <span class='kw2'>cast</span><span class='opr'>(</span><span class='kw3'>OutOfMemoryException</span><span class='opr'>)</span> <span class='kw2'>cast</span><span class='opr'>(</span><span class='kw4'>void</span><span class='opr'>*</span><span class='opr'>)</span> <span class='kw3'>OutOfMemoryException</span>.classinfo.init;
<span class='opr'>}</span>


<span class='com'>/**
 * A callback for switch errors in D.  A SwitchException will be thrown.
 *
 * Params:
 *  file = The name of the file that signaled this error.
 *  line = The line number on which this error occurred.
 *
 * Throws:
 *  SwitchException.
 */</span>
<span class='kw2'>extern</span> <span class='opr'>(</span>C<span class='opr'>)</span> <span class='kw4'>void</span> onSwitchError<span class='opr'>(</span> <span class='kw4'>char</span><span class='opr'>[</span><span class='opr'>]</span> file, <span class='kw4'>size_t</span> line <span class='opr'>)</span>
<span class='opr'>{</span>
    <span class='kw2'>throw</span> <span class='kw2'>new</span> SwitchException<span class='opr'>(</span> file, line <span class='opr'>)</span>;
<span class='opr'>}</span>


<span class='com'>/**
 * A callback for unicode errors in D.  A UnicodeException will be thrown.
 *
 * Params:
 *  msg = Information about the error.
 *  idx = String index where this error was detected.
 *
 * Throws:
 *  UnicodeException.
 */</span>
<span class='kw2'>extern</span> <span class='opr'>(</span>C<span class='opr'>)</span> <span class='kw4'>void</span> onUnicodeError<span class='opr'>(</span> <span class='kw4'>char</span><span class='opr'>[</span><span class='opr'>]</span> msg, <span class='kw4'>size_t</span> idx <span class='opr'>)</span>
<span class='opr'>{</span>
    <span class='kw2'>throw</span> <span class='kw2'>new</span> UnicodeException<span class='opr'>(</span> msg, idx <span class='opr'>)</span>;
<span class='opr'>}</span>
</pre></td></tr></table>	</body>
</html>
