<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html>
	<head>
		<link rel="stylesheet" href="../style.css" type="text/css" />
		<title>convert/Double.d</title>
	</head>
	<body>

<table id='dcode'><tr><td id='lnum'><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
</pre></td><td id='code'><pre><span class='com'>/*******************************************************************************

        copyright:      Copyright (c) 2004 Kris Bell. All rights reserved

        license:        BSD style: $(LICENSE)
        
        version:        Initial release: Nov 2005

        author:         Kris

*******************************************************************************/</span>

<span class='kw2'>module</span> tango.convert.Double;

<span class='kw4'>private</span> <span class='kw2'>import</span> tango.convert.Atoi;

<span class='kw4'>private</span> <span class='kw2'>extern</span> <span class='opr'>(</span>C<span class='opr'>)</span> <span class='kw4'>double</span> log10<span class='opr'>(</span><span class='kw4'>double</span> x<span class='opr'>)</span>;

<span class='com'>/******************************************************************************

        A set of functions for converting between string and floating-
        point values. 

******************************************************************************/</span>

<span class='kw4'>struct</span> DoubleT<span class='opr'>(</span>T<span class='opr'>)</span>
<span class='opr'>{</span>
        <span class='kw4'>static</span> <span class='kw1'>if</span> <span class='opr'>(</span>!<span class='kw2'>is</span> <span class='opr'>(</span>T <span class='opr'>=</span><span class='opr'>=</span> <span class='kw4'>char</span><span class='opr'>)</span> &amp;&amp; !<span class='kw2'>is</span> <span class='opr'>(</span>T <span class='opr'>=</span><span class='opr'>=</span> <span class='kw4'>wchar</span><span class='opr'>)</span> &amp;&amp; !<span class='kw2'>is</span> <span class='opr'>(</span>T <span class='opr'>=</span><span class='opr'>=</span> <span class='kw4'>dchar</span><span class='opr'>)</span><span class='opr'>)</span> 
                    <span class='kw2'>pragma</span> <span class='opr'>(</span>msg, <span class='str'>&quot;Template type must be char, wchar, or dchar&quot;</span><span class='opr'>)</span>;


        <span class='kw4'>private</span> <span class='kw2'>alias</span> AtoiT!<span class='opr'>(</span>T<span class='opr'>)</span> Atoi;

        <span class='com'>/**********************************************************************

                Convert a float to a string. This produces pretty
                good results for the most part, though one should
                use David Gay's dtoa package for best accuracy.

                Note that the approach first normalizes a base10
                mantissa, then pulls digits from the left side
                whilst emitting them (rightward) to the output.

        **********************************************************************/</span>

        <span class='kw4'>static</span> <span class='kw4'>final</span> T<span class='opr'>[</span><span class='opr'>]</span> format <span class='opr'>(</span>T<span class='opr'>[</span><span class='opr'>]</span> dst, <span class='kw4'>double</span> x, <span class='kw4'>uint</span> decimals <span class='opr'>=</span> <span class='nbr'>6</span>, <span class='kw4'>bool</span> scientific <span class='opr'>=</span> <span class='kw2'>false</span><span class='opr'>)</span>
        <span class='kw2'>in</span> <span class='opr'>{</span>
           <span class='kw2'>assert</span> <span class='opr'>(</span>dst.length <span class='opr'>&gt;</span><span class='opr'>=</span> <span class='nbr'>32</span><span class='opr'>)</span>;
           <span class='opr'>}</span>
        <span class='kw2'>body</span>
        <span class='opr'>{</span>
                <span class='com'>// function to strip digits from the</span>
                <span class='com'>// left of a normalized base-10 number</span>
                <span class='kw4'>static</span> <span class='kw4'>int</span> toDigit <span class='opr'>(</span><span class='kw2'>inout</span> <span class='kw4'>double</span> v, <span class='kw2'>inout</span> <span class='kw4'>int</span> count<span class='opr'>)</span>
                <span class='opr'>{</span>
                        <span class='kw4'>int</span> digit;

                        <span class='com'>// double can reliably hold 17 digits only</span>
                        <span class='kw1'>if</span> <span class='opr'>(</span><span class='opr'>+</span><span class='opr'>+</span>count <span class='opr'>&gt;</span> <span class='nbr'>17</span><span class='opr'>)</span>
                            digit <span class='opr'>=</span> <span class='nbr'>0</span>;
                        <span class='kw1'>else</span>
                           <span class='opr'>{</span>
                           <span class='com'>// remove leading digit, and bump</span>
                           digit <span class='opr'>=</span> <span class='kw2'>cast</span><span class='opr'>(</span><span class='kw4'>int</span><span class='opr'>)</span> v;
                           v <span class='opr'>=</span> <span class='opr'>(</span>v <span class='opr'>-</span> digit<span class='opr'>)</span> <span class='opr'>*</span> <span class='nbr'>10.0</span>;
                           <span class='opr'>}</span>
                        <span class='kw1'>return</span> digit <span class='opr'>+</span> <span class='str'>'0'</span>;
                <span class='opr'>}</span>

                <span class='com'>// test for nan/infinity</span>
                <span class='kw1'>if</span> <span class='opr'>(</span><span class='opr'>(</span><span class='opr'>(</span><span class='kw2'>cast</span><span class='opr'>(</span><span class='kw4'>ushort</span><span class='opr'>*</span><span class='opr'>)</span> <span class='opr'>&amp;</span>x<span class='opr'>)</span><span class='opr'>[</span><span class='nbr'>3</span><span class='opr'>]</span> <span class='opr'>&amp;</span> <span class='nbr'>0</span>x7ff0<span class='opr'>)</span> <span class='opr'>=</span><span class='opr'>=</span> <span class='nbr'>0</span>x7ff0<span class='opr'>)</span>
                      <span class='kw1'>if</span> <span class='opr'>(</span><span class='opr'>*</span><span class='opr'>(</span><span class='kw2'>cast</span><span class='opr'>(</span><span class='kw4'>ulong</span><span class='opr'>*</span><span class='opr'>)</span> <span class='opr'>&amp;</span>x<span class='opr'>)</span> <span class='opr'>&amp;</span> <span class='nbr'>0</span>x000f_ffff_ffff_ffff<span class='opr'>)</span>
                            <span class='kw1'>return</span> <span class='str'>&quot;nan&quot;</span>;
                      <span class='kw1'>else</span>
                         <span class='kw1'>return</span> <span class='str'>&quot;inf&quot;</span>;

                <span class='kw4'>int</span> exp;
                <span class='kw4'>bool</span> sign;
        
                <span class='com'>// extract the sign</span>
                <span class='kw1'>if</span> <span class='opr'>(</span>x <span class='opr'>&lt;</span> <span class='nbr'>0.0</span><span class='opr'>)</span>
                   <span class='opr'>{</span>
                   x <span class='opr'>=</span> <span class='opr'>-</span>x;
                   sign <span class='opr'>=</span> <span class='kw2'>true</span>;
                   <span class='opr'>}</span>

                <span class='com'>// don't scale if zero</span>
                <span class='kw1'>if</span> <span class='opr'>(</span>x <span class='opr'>&gt;</span> <span class='nbr'>0.0</span><span class='opr'>)</span>
                   <span class='opr'>{</span>
                   <span class='com'>// round up a bit (should do even/odd test?)</span>
                   x <span class='opr'>+=</span> <span class='nbr'>0.5</span> / pow10 <span class='opr'>(</span>decimals<span class='opr'>)</span>;

                   <span class='com'>// extract base10 exponent</span>
                   exp <span class='opr'>=</span> <span class='kw2'>cast</span><span class='opr'>(</span><span class='kw4'>int</span><span class='opr'>)</span> log10 <span class='opr'>(</span>x<span class='opr'>)</span>;

                   <span class='com'>// normalize base10 mantissa (0 &lt; m &lt; 10)</span>
                   <span class='kw4'>int</span> len <span class='opr'>=</span> exp;
                   <span class='kw1'>if</span> <span class='opr'>(</span>exp <span class='opr'>&lt;</span> <span class='nbr'>0</span><span class='opr'>)</span>
                       x <span class='opr'>*=</span> pow10 <span class='opr'>(</span>len <span class='opr'>=</span> <span class='opr'>-</span>exp<span class='opr'>)</span>;
                   <span class='kw1'>else</span>
                      x <span class='opr'>/=</span> pow10 <span class='opr'>(</span>exp<span class='opr'>)</span>;

                   <span class='com'>// switch to short display if not enough space</span>
                   <span class='kw1'>if</span> <span class='opr'>(</span>len <span class='opr'>+</span> <span class='nbr'>32</span> <span class='opr'>&gt;</span> dst.length<span class='opr'>)</span>
                       scientific <span class='opr'>=</span> <span class='kw2'>true</span>;
                   <span class='opr'>}</span>

                T<span class='opr'>*</span> p <span class='opr'>=</span> dst;
                <span class='kw4'>int</span> count <span class='opr'>=</span> <span class='nbr'>0</span>;

                <span class='com'>// emit sign</span>
                <span class='kw1'>if</span> <span class='opr'>(</span>sign<span class='opr'>)</span>
                    <span class='opr'>*</span>p<span class='opr'>+</span><span class='opr'>+</span> <span class='opr'>=</span> <span class='str'>'-'</span>;

                <span class='com'>// are we doing +/-exp format?</span>
                <span class='kw1'>if</span> <span class='opr'>(</span>scientific<span class='opr'>)</span>
                   <span class='opr'>{</span>
                   <span class='com'>// emit first digit, and decimal point</span>
                   <span class='opr'>*</span>p<span class='opr'>+</span><span class='opr'>+</span> <span class='opr'>=</span> toDigit <span class='opr'>(</span>x, count<span class='opr'>)</span>;
                   <span class='opr'>*</span>p<span class='opr'>+</span><span class='opr'>+</span> <span class='opr'>=</span> <span class='str'>'.'</span>;

                   <span class='com'>// emit rest of mantissa</span>
                   <span class='kw1'>while</span> <span class='opr'>(</span>decimals<span class='opr'>-</span><span class='opr'>-</span> <span class='opr'>&gt;</span> <span class='nbr'>0</span><span class='opr'>)</span>
                          <span class='opr'>*</span>p<span class='opr'>+</span><span class='opr'>+</span> <span class='opr'>=</span> toDigit <span class='opr'>(</span>x, count<span class='opr'>)</span>;

                   <span class='com'>// emit exponent, if non zero</span>
                   <span class='kw1'>if</span> <span class='opr'>(</span>exp<span class='opr'>)</span>
                      <span class='opr'>{</span>
                      <span class='opr'>*</span>p<span class='opr'>+</span><span class='opr'>+</span> <span class='opr'>=</span> <span class='str'>'e'</span>;
                      <span class='opr'>*</span>p<span class='opr'>+</span><span class='opr'>+</span> <span class='opr'>=</span> <span class='opr'>(</span>exp <span class='opr'>&lt;</span> <span class='nbr'>0</span><span class='opr'>)</span> ? <span class='str'>'-'</span> : <span class='str'>'+'</span>;
                      <span class='kw1'>if</span> <span class='opr'>(</span>exp <span class='opr'>&lt;</span> <span class='nbr'>0</span><span class='opr'>)</span>
                          exp <span class='opr'>=</span> <span class='opr'>-</span>exp;

                      <span class='kw1'>if</span> <span class='opr'>(</span>exp <span class='opr'>&gt;</span><span class='opr'>=</span> <span class='nbr'>100</span><span class='opr'>)</span>
                         <span class='opr'>{</span>
                         <span class='opr'>*</span>p<span class='opr'>+</span><span class='opr'>+</span> <span class='opr'>=</span> <span class='opr'>(</span>exp/<span class='nbr'>100</span><span class='opr'>)</span> <span class='opr'>+</span> <span class='str'>'0'</span>;
                         exp <span class='opr'>%</span><span class='opr'>=</span> <span class='nbr'>100</span>;
                         <span class='opr'>}</span>

                      <span class='opr'>*</span>p<span class='opr'>+</span><span class='opr'>+</span> <span class='opr'>=</span> <span class='opr'>(</span>exp/<span class='nbr'>10</span><span class='opr'>)</span> <span class='opr'>+</span> <span class='str'>'0'</span>;
                      <span class='opr'>*</span>p<span class='opr'>+</span><span class='opr'>+</span> <span class='opr'>=</span> <span class='opr'>(</span>exp<span class='opr'>%</span><span class='nbr'>10</span><span class='opr'>)</span> <span class='opr'>+</span> <span class='str'>'0'</span>;
                      <span class='opr'>}</span>
                   <span class='opr'>}</span>
                <span class='kw1'>else</span>
                   <span class='opr'>{</span>
                   <span class='com'>// if fraction only, emit a leading zero</span>
                   <span class='kw1'>if</span> <span class='opr'>(</span>exp <span class='opr'>&lt;</span> <span class='nbr'>0</span><span class='opr'>)</span>
                       <span class='opr'>*</span>p<span class='opr'>+</span><span class='opr'>+</span> <span class='opr'>=</span> <span class='str'>'0'</span>;
                   <span class='kw1'>else</span>
                      <span class='com'>// emit all digits to the left of point</span>
                      <span class='kw1'>for</span> <span class='opr'>(</span>; exp <span class='opr'>&gt;</span><span class='opr'>=</span> <span class='nbr'>0</span>; <span class='opr'>-</span><span class='opr'>-</span>exp<span class='opr'>)</span>
                             <span class='opr'>*</span>p<span class='opr'>+</span><span class='opr'>+</span> <span class='opr'>=</span> toDigit <span class='opr'>(</span>x, count<span class='opr'>)</span>;

                   <span class='com'>// emit point</span>
                   <span class='opr'>*</span>p<span class='opr'>+</span><span class='opr'>+</span> <span class='opr'>=</span> <span class='str'>'.'</span>;

                   <span class='com'>// emit leading fractional zeros?</span>
                   <span class='kw1'>for</span> <span class='opr'>(</span><span class='opr'>+</span><span class='opr'>+</span>exp; exp <span class='opr'>&lt;</span> <span class='nbr'>0</span> &amp;&amp; decimals <span class='opr'>&gt;</span> <span class='nbr'>0</span>; <span class='opr'>-</span><span class='opr'>-</span>decimals, <span class='opr'>+</span><span class='opr'>+</span>exp<span class='opr'>)</span>
                        <span class='opr'>*</span>p<span class='opr'>+</span><span class='opr'>+</span> <span class='opr'>=</span> <span class='str'>'0'</span>;

                   <span class='com'>// output remaining digits, if any. Trailing</span>
                   <span class='com'>// zeros are also returned from toDigit()</span>
                   <span class='kw1'>while</span> <span class='opr'>(</span>decimals<span class='opr'>-</span><span class='opr'>-</span> <span class='opr'>&gt;</span> <span class='nbr'>0</span><span class='opr'>)</span>
                          <span class='opr'>*</span>p<span class='opr'>+</span><span class='opr'>+</span> <span class='opr'>=</span> toDigit <span class='opr'>(</span>x, count<span class='opr'>)</span>;
                   <span class='opr'>}</span>

                <span class='kw1'>return</span> dst <span class='opr'>[</span><span class='nbr'>0.</span>.<span class='opr'>(</span>p <span class='opr'>-</span> dst.ptr<span class='opr'>)</span><span class='opr'>]</span>;
        <span class='opr'>}</span>


        <span class='com'>/**********************************************************************

                Convert a formatted string of digits to a floating-
                point number. Good for general use, but use David
                Gay's dtoa package if serious rounding adjustments
                should be applied.

        **********************************************************************/</span>

        <span class='kw4'>final</span> <span class='kw4'>static</span> <span class='kw4'>double</span> parse <span class='opr'>(</span>T<span class='opr'>[</span><span class='opr'>]</span> src, <span class='kw4'>uint</span><span class='opr'>*</span> ate<span class='opr'>=</span><span class='kw2'>null</span><span class='opr'>)</span>
        <span class='opr'>{</span>
                T               c;
                T<span class='opr'>*</span>              p;
                <span class='kw4'>int</span>             exp;
                <span class='kw4'>bool</span>            sign;
                <span class='kw4'>uint</span>            radix;
                <span class='kw4'>double</span>          value <span class='opr'>=</span> <span class='nbr'>0.0</span>;

                <span class='com'>// remove leading space, and sign</span>
                c <span class='opr'>=</span> <span class='opr'>*</span><span class='opr'>(</span>p <span class='opr'>=</span> src.ptr <span class='opr'>+</span> Atoi.trim <span class='opr'>(</span>src, sign, radix<span class='opr'>)</span><span class='opr'>)</span>;

                <span class='com'>// handle non-decimal representations</span>
                <span class='kw1'>if</span> <span class='opr'>(</span>radix <span class='opr'>!=</span> <span class='nbr'>10</span><span class='opr'>)</span>
                   <span class='opr'>{</span>
                   <span class='kw4'>long</span> v <span class='opr'>=</span> Atoi.parse <span class='opr'>(</span>src, radix, ate<span class='opr'>)</span>; 
                   <span class='kw1'>return</span> <span class='opr'>*</span><span class='kw2'>cast</span><span class='opr'>(</span><span class='kw4'>double</span><span class='opr'>*</span><span class='opr'>)</span> <span class='opr'>&amp;</span>v;
                   <span class='opr'>}</span>

                <span class='com'>// read leading digits; note that leading</span>
                <span class='com'>// zeros are simply multiplied away.</span>
                <span class='kw1'>while</span> <span class='opr'>(</span>c <span class='opr'>&gt;</span><span class='opr'>=</span> <span class='str'>'0'</span> &amp;&amp; c <span class='opr'>&lt;</span><span class='opr'>=</span> <span class='str'>'9'</span><span class='opr'>)</span>
                      <span class='opr'>{</span>
                      value <span class='opr'>=</span> value <span class='opr'>*</span> <span class='nbr'>10</span> <span class='opr'>+</span> <span class='opr'>(</span>c <span class='opr'>-</span> <span class='str'>'0'</span><span class='opr'>)</span>;
                      c <span class='opr'>=</span> <span class='opr'>*</span><span class='opr'>+</span><span class='opr'>+</span>p;
                      <span class='opr'>}</span>

                <span class='com'>// gobble up the point</span>
                <span class='kw1'>if</span> <span class='opr'>(</span>c <span class='opr'>=</span><span class='opr'>=</span> <span class='str'>'.'</span><span class='opr'>)</span>
                    c <span class='opr'>=</span> <span class='opr'>*</span><span class='opr'>+</span><span class='opr'>+</span>p;

                <span class='com'>// read fractional digits; note that we accumulate</span>
                <span class='com'>// all digits ... very long numbers impact accuracy</span>
                <span class='com'>// to a degree, but perhaps not as much as one might</span>
                <span class='com'>// expect. A prior version limited the digit count,</span>
                <span class='com'>// but did not show marked improvement. For maximum</span>
                <span class='com'>// accuracy when reading and writing, use David Gay's</span>
                <span class='com'>// dtoa package instead.</span>
                <span class='kw1'>while</span> <span class='opr'>(</span>c <span class='opr'>&gt;</span><span class='opr'>=</span> <span class='str'>'0'</span> &amp;&amp; c <span class='opr'>&lt;</span><span class='opr'>=</span> <span class='str'>'9'</span><span class='opr'>)</span>
                      <span class='opr'>{</span>
                      value <span class='opr'>=</span> value <span class='opr'>*</span> <span class='nbr'>10</span> <span class='opr'>+</span> <span class='opr'>(</span>c <span class='opr'>-</span> <span class='str'>'0'</span><span class='opr'>)</span>;
                      c <span class='opr'>=</span> <span class='opr'>*</span><span class='opr'>+</span><span class='opr'>+</span>p;
                      <span class='opr'>-</span><span class='opr'>-</span>exp;
                      <span class='opr'>}</span> 

                <span class='com'>// did we get something?</span>
                <span class='kw1'>if</span> <span class='opr'>(</span>value<span class='opr'>)</span>
                   <span class='opr'>{</span>
                   <span class='com'>// parse base10 exponent?</span>
                   <span class='kw1'>if</span> <span class='opr'>(</span>c <span class='opr'>=</span><span class='opr'>=</span> <span class='str'>'e'</span> || c <span class='opr'>=</span><span class='opr'>=</span> <span class='str'>'E'</span><span class='opr'>)</span>
                      <span class='opr'>{</span>
                      <span class='kw4'>uint</span> eaten;
                      exp <span class='opr'>+=</span> Atoi.parse <span class='opr'>(</span>src<span class='opr'>[</span><span class='opr'>(</span>p<span class='opr'>-</span>src.ptr<span class='opr'>)</span><span class='opr'>+</span><span class='nbr'>1.</span>.length<span class='opr'>]</span>, <span class='nbr'>0</span>, <span class='opr'>&amp;</span>eaten<span class='opr'>)</span>;
                      p <span class='opr'>+=</span> eaten;
                      <span class='opr'>}</span>

                   <span class='com'>// adjust mantissa; note that the exponent has</span>
                   <span class='com'>// already been adjusted for fractional digits</span>
                   <span class='kw1'>if</span> <span class='opr'>(</span>exp <span class='opr'>&lt;</span> <span class='nbr'>0</span><span class='opr'>)</span>
                       value <span class='opr'>/=</span> pow10 <span class='opr'>(</span><span class='opr'>-</span>exp<span class='opr'>)</span>;
                   <span class='kw1'>else</span>
                      value <span class='opr'>*=</span> pow10 <span class='opr'>(</span>exp<span class='opr'>)</span>;
                   <span class='opr'>}</span>
                <span class='kw1'>else</span>
                   <span class='com'>// was it was nan instead?</span>
                   <span class='kw1'>if</span> <span class='opr'>(</span>p <span class='opr'>=</span><span class='opr'>=</span> src.ptr<span class='opr'>)</span>
                       <span class='kw1'>if</span> <span class='opr'>(</span>p<span class='opr'>[</span><span class='nbr'>0..3</span><span class='opr'>]</span> <span class='opr'>=</span><span class='opr'>=</span> <span class='str'>&quot;inf&quot;</span><span class='opr'>)</span>
                           p <span class='opr'>+=</span> <span class='nbr'>3</span>, value <span class='opr'>=</span> <span class='kw4'>double</span>.infinity;
                       <span class='kw1'>else</span>
                          <span class='kw1'>if</span> <span class='opr'>(</span>p<span class='opr'>[</span><span class='nbr'>0..3</span><span class='opr'>]</span> <span class='opr'>=</span><span class='opr'>=</span> <span class='str'>&quot;nan&quot;</span><span class='opr'>)</span>
                              p <span class='opr'>+=</span> <span class='nbr'>3</span>, value <span class='opr'>=</span> <span class='kw4'>double</span>.nan;

                <span class='com'>// set parse length, and return value</span>
                <span class='kw1'>if</span> <span class='opr'>(</span>ate<span class='opr'>)</span>
                    <span class='opr'>*</span>ate <span class='opr'>=</span> p <span class='opr'>-</span> src.ptr;
                <span class='kw1'>return</span> sign ? <span class='opr'>-</span>value : value; 
        <span class='opr'>}</span>


        <span class='com'>/**********************************************************************

                Internal function to convert an exponent specifier to 
                a floating point value.
                 
        **********************************************************************/</span>

        <span class='kw4'>private</span> <span class='kw4'>static</span> <span class='kw4'>final</span> <span class='kw4'>double</span> pow10 <span class='opr'>(</span><span class='kw4'>uint</span> exp<span class='opr'>)</span>
        <span class='kw2'>in</span> <span class='opr'>{</span>
           <span class='kw2'>assert</span> <span class='opr'>(</span>exp <span class='opr'>&lt;</span> <span class='nbr'>512</span><span class='opr'>)</span>;
           <span class='opr'>}</span>    
        <span class='kw2'>body</span>
        <span class='opr'>{</span>
                <span class='kw4'>static</span>  <span class='kw4'>double</span><span class='opr'>[</span><span class='opr'>]</span> Powers <span class='opr'>=</span> 
                        <span class='opr'>[</span>
                        <span class='nbr'>1.0e1</span>,
                        <span class='nbr'>1.0e2</span>,
                        <span class='nbr'>1.0e4</span>,
                        <span class='nbr'>1.0e8</span>,
                        <span class='nbr'>1.0e16</span>,
                        <span class='nbr'>1.0e32</span>,
                        <span class='nbr'>1.0e64</span>,
                        <span class='nbr'>1.0e128</span>,
                        <span class='nbr'>1.0e256</span>,
                        <span class='opr'>]</span>;

                <span class='kw4'>double</span> mult <span class='opr'>=</span> <span class='nbr'>1.0</span>;
                <span class='kw1'>foreach</span> <span class='opr'>(</span><span class='kw4'>double</span> power; Powers<span class='opr'>)</span>
                        <span class='opr'>{</span>
                        <span class='kw1'>if</span> <span class='opr'>(</span>exp <span class='opr'>&amp;</span> <span class='nbr'>1</span><span class='opr'>)</span>
                            mult <span class='opr'>*=</span> power;
                        <span class='kw1'>if</span> <span class='opr'>(</span><span class='opr'>(</span>exp <span class='opr'>&gt;</span><span class='opr'>&gt;</span><span class='opr'>=</span> <span class='nbr'>1</span><span class='opr'>)</span> <span class='kw2'>is</span> <span class='nbr'>0</span><span class='opr'>)</span>
                             <span class='kw1'>break</span>;
                        <span class='opr'>}</span>
                <span class='kw1'>return</span> mult;
        <span class='opr'>}</span>
<span class='opr'>}</span>


<span class='com'>/******************************************************************************

******************************************************************************/</span>

<span class='kw2'>alias</span> DoubleT!<span class='opr'>(</span><span class='kw4'>char</span><span class='opr'>)</span> Double;


</pre></td></tr></table>	</body>
</html>
